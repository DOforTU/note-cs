# 04. Priority Queue

## 4.1 Priority Queue: Heap

Priority Queue는 일반적인 큐(Queue)와는 다르게, **우선순위(priority)** 를 기준으로 데이터를 꺼내는 자료구조이다. 일반 큐는 먼저 들어온 데이터가 먼저 나가지만, Priority Queue는 **우선순위가 가장 높은 데이터가 먼저 나가는 구조**이다.

이 구조는 주로 **Heap**이라는 자료구조를 사용하여 구현된다. Heap은 완전 이진 트리의 일종이며, 보통 **Min-Heap** 또는 **Max-Heap** 형태로 사용된다:

- **Min-Heap**은 가장 작은 값을 루트에 두고, 부모 노드가 항상 자식 노드보다 작거나 같다.
    
- **Max-Heap**은 가장 큰 값을 루트에 두고, 부모 노드가 항상 자식 노드보다 크거나 같다.
    

Priority Queue에서 데이터를 삽입하거나 삭제할 때는 Heap 구조를 유지해야 한다. 이를 위해 다음과 같은 연산이 사용된다:

1. **삽입 (insert)**: 데이터를 트리의 가장 마지막 위치에 넣은 후, 부모와 비교하면서 위로 올리는 작업을 반복한다. 이 과정을 **heapify up** 또는 **bubble up**이라고 부른다.
    
2. **삭제 (pop or extract)**: 루트 노드를 꺼내고, 마지막 노드를 루트로 옮긴 후, 자식 노드와 비교하면서 아래로 내려보낸다. 이 과정을 **heapify down** 또는 **bubble down**이라고 부른다.
    

이러한 연산들은 모두 $O(\log n)$의 시간 복잡도를 가진다. 왜냐하면 Heap은 트리의 높이에 따라 동작하며, 완전 이진 트리의 높이는 $\log n$이기 때문이다.

Priority Queue는 다음과 같은 상황에서 유용하게 사용된다:

- **CPU 스케줄링**: 우선순위가 높은 작업을 먼저 처리해야 할 때
    
- **다익스트라 알고리즘**: 최단 경로 탐색에서 가장 비용이 적은 노드를 먼저 선택할 때
    
- **이벤트 처리 시스템**: 시간이 빠른 이벤트를 먼저 처리할 때
    

파이썬에서는 `heapq` 모듈을 사용하여 Priority Queue를 구현할 수 있다. 이 모듈은 기본적으로 Min-Heap을 제공하며, 우선순위를 뒤집기 위해 튜플이나 음수 값을 사용하는 기법이 자주 사용된다.

Heap의 내부 구조는 배열로 구현된다. 배열의 인덱스를 이용해 부모와 자식 노드를 계산할 수 있기 때문에, 트리를 따로 만들 필요 없이 효율적으로 연산을 처리할 수 있다. 예를 들어, 인덱스 $i$에 있는 노드의 자식 노드는 $2i + 1$과 $2i + 2$, 부모 노드는 $\lfloor(i - 1) / 2\rfloor$로 계산할 수 있다.

Heap은 알고리즘 문제에서 빠르게 최댓값 또는 최솟값을 꺼내야 할 때 자주 사용된다.
